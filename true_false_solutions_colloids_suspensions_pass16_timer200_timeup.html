<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ถูกหรือผิด – สารละลาย • คอลลอยด์ • แขวนลอย | จับเวลา 200 วิ</title>
<style>
  :root{
    --bg:#f7fbff; --card:#ffffff; --ink:#0f172a; --brand:#2563eb;
    --good:#16a34a; --bad:#dc2626; --muted:#64748b;
    --ring:0 8px 30px rgba(37,99,235,.15);
    --btn:#f1f5f9; --btnBorder:#e5e7eb; --btnActive:#dbeafe;
    --timer:#0ea5e9; --timerDanger:#ef4444;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);
    font-family:"Noto Sans Thai",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
  .wrap{max-width:1040px;margin:0 auto;padding:24px}
  .card{background:var(--card);border-radius:20px;box-shadow:var(--ring);padding:20px}
  h1{margin:8px 0 4px;font-size:clamp(22px,3.6vw,34px)}
  .brand{font-weight:800;color:var(--brand)}
  .badge{display:inline-block;padding:6px 12px;border-radius:999px;background:#eef2ff;color:#3730a3;font-weight:700;font-size:14px}
  .sub{color:var(--muted)}
  .start{display:grid;gap:16px;max-width:560px;margin:12px auto}
  input[type="text"]{width:100%;padding:14px 16px;border-radius:14px;border:1px solid #e5e7eb;font-size:18px;outline:none}
  input[type="text"]:focus{border-color:var(--brand);box-shadow:0 0 0 4px rgba(37,99,235,.15)}
  button{appearance:none;border:0;background:var(--brand);color:#fff;font-weight:700;
    padding:14px 18px;border-radius:14px;cursor:pointer;font-size:18px;box-shadow:var(--ring)}
  button.secondary{background:#0ea5e9}
  button.ghost{background:#e5e7eb;color:#111827}
  .kru{margin-top:18px;font-weight:800;letter-spacing:.3px;color:#111827}
  .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
  .result{margin-top:16px;padding:12px;border-radius:14px;background:#f1f5f9;display:none}
  .ok{color:var(--good);font-weight:800}
  .ng{color:var(--bad);font-weight:800}
  .tiny{font-size:13px;color:var(--muted)}
  .tick{font-weight:800;margin-left:10px}
  .tick.hidden{visibility:hidden}
  /* Question row */
  .qrow{display:grid;gap:12px;align-items:center;grid-template-columns:1fr minmax(220px,280px);
    background:#f8fafc;border:1px solid #e5e7eb;border-radius:14px;padding:12px}
  @media (max-width:700px){.qrow{grid-template-columns:1fr}}
  .qtext{font-size:16px}
  .opts{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
  .btnopt{display:flex;justify-content:center;align-items:center;gap:6px;
    padding:10px 12px;border-radius:12px;border:1px solid var(--btnBorder);
    background:var(--btn);color:#111827;font-size:15px;cursor:pointer;user-select:none}
  .btnopt.selected{background:var(--btnActive);border-color:#93c5fd}
  .answers{margin-top:10px;display:none}
  .answers .a{padding:8px 10px;border-radius:10px;background:#fff;border:1px dashed #e5e7eb;margin-top:6px}
  .pass{color:#065f46;font-weight:900}
  .fail{color:#b91c1c;font-weight:900}

  /* Timer bar */
  .timerWrap{margin:10px 0 14px}
  .timerBar{height:12px;background:#e2e8f0;border-radius:999px;overflow:hidden}
  .timerFill{height:100%;width:100%;background:var(--timer);transition:width .5s linear}
  .timerRow{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  .timeText{font-weight:800}

  /* Time-up banner */
  #timeUpBanner{
    display:none;
    position:fixed; inset:0;
    background:rgba(0,0,0,.5);
    z-index:9999;
    align-items:center; justify-content:center;
    padding:20px;
  }
  #timeUpBanner .box{
    background:#fff; border-radius:18px; padding:20px;
    max-width:520px; width:100%;
    box-shadow:0 20px 60px rgba(0,0,0,.25);
    text-align:center;
  }
  #timeUpBanner h3{margin:0 0 8px; font-size:24px; color:#b91c1c}
  #timeUpBanner p{margin:0 0 12px; color:#374151}
</style>
</head>
<body>
  <div class="wrap">
    <div id="screen-start" class="card">
      <div class="badge">Kru Pai Classroom</div>
      <h1>เกมถูกหรือผิด <span class="brand">สารละลาย • คอลลอยด์ • แขวนลอย</span></h1>
      <div class="sub">ทำให้ครบใน <b>200 วินาที</b> แล้วระบบจะตรวจให้อัตโนมัติ — เกณฑ์ผ่าน <b>16/20</b></div>
      <div class="start">
        <label>ชื่อนักเรียน</label>
        <input id="player" type="text" placeholder="พิมพ์ชื่อเล่น..." />
        <button id="startBtn">เริ่มเกม</button>
      </div>
    </div>

    <div id="screen-game" class="card" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
        <div class="badge">Kru Pai Classroom</div>
        <div class="kru" id="who"></div>
      </div>

      <div class="timerWrap">
        <div class="timerRow">
          <div class="timeText">เวลาเหลือ: <span id="timeLeft">03:20</span></div>
          <div class="tiny">ครบ 200 วิจะตรวจให้อัตโนมัติ</div>
        </div>
        <div class="timerBar"><div id="timerFill" class="timerFill"></div></div>
      </div>

      <h2 style="margin:10px 0 8px">แบบฝึก: ถูกหรือผิด (20 ข้อ)</h2>
      <div id="qwrap" class="grid" style="display:grid;gap:12px"></div>

      <div class="actions">
        <button id="checkBtn">ตรวจคำตอบ</button>
        <button class="secondary" id="resetBtn">ล้างคำตอบ</button>
        <button class="ghost" id="backBtn">กลับหน้าแรก</button>
      </div>

      <div id="result" class="result"></div>

      <div class="actions" id="afterActions" style="display:none">
        <button class="secondary" id="toggleAns">ดูเฉลย</button>
        <button class="ghost" id="againBtn">ทำใหม่</button>
      </div>

      <div id="answers" class="answers"></div>
    </div>
  </div>

  <!-- Time-up modal -->
  <div id="timeUpBanner">
    <div class="box">
      <h3>⏰ หมดเวลาแล้ว!</h3>
      <p>ระบบตรวจคำตอบให้อัตโนมัติ และล็อกการเลือกคำตอบ</p>
      <button id="viewResultBtn">ดูผลลัพธ์</button>
    </div>
  </div>

<script>
const PASS_THRESHOLD = 16;
const TOTAL_SECONDS = 200;
let secondsLeft = TOTAL_SECONDS;
let timerId = null;

// True/False items
const items = [
  {text:"1) สารละลายเป็นสารผสมเนื้อเดียว", correct:true, explain:"อนุภาคกระจายตัวสม่ำเสมอ มองไม่เห็นขอบเขตแยกชั้น"},
  {text:"2) คอลลอยด์เป็นสารผสมเนื้อเดียว", correct:false, explain:"คอลลอยด์เป็นสารเนื้อผสม (ไม่เป็นเนื้อเดียว) แต่กระจายตัวละเอียด"},
  {text:"3) สารแขวนลอยมีอนุภาคขนาดใหญ่กว่าสารละลาย", correct:true, explain:"แขวนลอย > คอลลอยด์ > สารละลาย (ตามขนาดอนุภาค)"},
  {text:"4) น้ำเกลือใส เป็นตัวอย่างของสารแขวนลอย", correct:false, explain:"น้ำเกลือใสเป็นสารละลาย (เนื้อเดียว)"},
  {text:"5) น้ำนมเป็นตัวอย่างของคอลลอยด์", correct:true, explain:"เป็นอีมัลชัน (ของเหลวกระจายตัวในของเหลว)"},
  {text:"6) สารละลายสามารถกรองด้วยกระดาษกรองเพื่อแยกสารได้", correct:false, explain:"อนุภาคเล็กมาก ไม่ถูกกรองด้วยกระดาษกรองทั่วไป"},
  {text:"7) สารแขวนลอยสามารถแยกด้วยการกรอง", correct:true, explain:"อนุภาคใหญ่พอให้กระดาษกรองกั้นได้"},
  {text:"8) แป้งผสมน้ำเป็นตัวอย่างของคอลลอยด์", correct:true, explain:"เป็น sol/คอลลอยด์ของอนุภาคแป้งในน้ำ (ขึ้นกับความเข้มข้น)"},
  {text:"9) หมอกและควันเป็นตัวอย่างของคอลลอยด์", correct:true, explain:"หมอก = ของเหลวในแก๊ส, ควัน = ของแข็งในแก๊ส"},
  {text:"10) น้ำโคลนเป็นตัวอย่างของสารแขวนลอย", correct:true, explain:"อนุภาคดิน/โคลนใหญ่และตกตะกอนได้"},
  {text:"11) สารละลายมีการกระเจิงแสงได้น้อยมากหรือไม่มีเลย", correct:true, explain:"จึงไม่เห็นลำแสงผ่านสารละลายชัดเจน"},
  {text:"12) คอลลอยด์แสดงปรากฏการณ์ Tyndall (กระเจิงแสง)", correct:true, explain:"ลำแสงมองเห็นเมื่อผ่านคอลลอยด์"},
  {text:"13) สารแขวนลอยมีอนุภาคที่ตกตะกอนเมื่อปล่อยทิ้งไว้", correct:true, explain:"ข้อสังเกตสำคัญของแขวนลอย"},
  {text:"14) น้ำเชื่อมใสจัดเป็นคอลลอยด์", correct:false, explain:"น้ำเชื่อมใสเป็นสารละลายของน้ำตาลในน้ำ"},
  {text:"15) เจลาตินในน้ำเป็นตัวอย่างของคอลลอยด์", correct:true, explain:"เป็น sol/gel คอลลอยด์ของโปรตีนในน้ำ"},
  {text:"16) น้ำหมึกเป็นตัวอย่างของสารละลาย", correct:true, explain:"หมึกสีย้อมส่วนมากเป็นสารละลายของสีย้อม (บางชนิดอาจเป็นคอลลอยด์/แขวนลอย)"},
  {text:"17) อากาศบริสุทธิ์เป็นตัวอย่างของสารละลาย", correct:true, explain:"เป็นสารผสมเนื้อเดียวของก๊าซหลายชนิด (สารละลายก๊าซ)"},
  {text:"18) น้ำทะเลเป็นสารแขวนลอย", correct:false, explain:"โดยหลักเป็นสารละลาย (มีเกลือละลาย), อาจมีคอลลอยด์/แขวนลอยปนเล็กน้อย"},
  {text:"19) เครื่องปั่นแยกสาร (centrifuge) สามารถใช้แยกคอลลอยด์บางชนิดได้", correct:true, explain:"อัลตราเซ็นตริฟิวจ์ช่วยทำให้คอลลอยด์แยกตัวได้"},
  {text:"20) คอลลอยด์และสารแขวนลอยมีอนุภาคขนาดเท่ากัน", correct:false, explain:"คอลลอยด์มีขนาดเล็กกว่าแขวนลอย"}
];

const $ = s=>document.querySelector(s);
const qwrap = $('#qwrap');
const resultEl = $('#result');
const answersEl = $('#answers');
const timeLeftEl = $('#timeLeft');
const timerFillEl = $('#timerFill');
const banner = document.getElementById('timeUpBanner');
const viewResultBtn = document.getElementById('viewResultBtn');

/* Render questions */
items.forEach((it, idx)=>{
  const i = idx+1;
  const row = document.createElement('div');
  row.className = 'qrow';
  row.dataset.index = i;
  row.innerHTML = `
    <div class="qtext">${it.text} <span id="tick-${i}" class="tick hidden">✓</span></div>
    <div class="opts" id="opts-${i}">
      <button type="button" class="btnopt" data-val="true">✅ ถูก</button>
      <button type="button" class="btnopt" data-val="false">❌ ผิด</button>
    </div>
  `;
  qwrap.appendChild(row);

  // add events
  row.querySelectorAll('.btnopt').forEach(btn=>{
    btn.addEventListener('click', ()=>select(i, btn.dataset.val, btn));
  });
});

/* selections */
const selected = {}; // {index: true/false}
function select(i, val, btn){
  // unselect others
  document.querySelectorAll(`#opts-${i} .btnopt`).forEach(b=>b.classList.remove('selected'));
  btn.classList.add('selected');
  selected[i] = (val === 'true');
}

/* Timer helpers */
function fmt(sec){
  const m = Math.floor(sec/60).toString().padStart(1,'0');
  const s = Math.floor(sec%60).toString().padStart(2,'0');
  return `${m}:${s}`;
}
function updateTimerUI(){
  timeLeftEl.textContent = fmt(secondsLeft);
  const pct = Math.max(0, (secondsLeft / TOTAL_SECONDS) * 100);
  timerFillEl.style.width = pct + '%';
  if(secondsLeft <= 20){ timerFillEl.style.background = 'var(--timerDanger)'; }
}

/* buttons */
document.getElementById('startBtn').addEventListener('click', ()=>{
  const name = document.getElementById('player').value.trim() || 'นักเรียน';
  document.getElementById('who').textContent = `ผู้เล่น: ${name}`;
  document.getElementById('screen-start').style.display='none';
  document.getElementById('screen-game').style.display='block';
  window.scrollTo({top:0, behavior:'smooth'});
  // start timer
  secondsLeft = TOTAL_SECONDS;
  updateTimerUI();
  timerId = setInterval(()=>{
    secondsLeft--;
    updateTimerUI();
    if(secondsLeft <= 0){
      clearInterval(timerId);
      autoSubmit();
    }
  }, 1000);
});

document.getElementById('backBtn').addEventListener('click', ()=>location.reload());

document.getElementById('resetBtn').addEventListener('click', ()=>{
  Object.keys(selected).forEach(k=>delete selected[k]);
  document.querySelectorAll('.btnopt').forEach(b=>b.classList.remove('selected'));
  document.querySelectorAll('.tick').forEach(t=>{ t.classList.add('hidden'); t.textContent='✓'; t.style.color='inherit'; });
  resultEl.style.display='none';
  document.getElementById('afterActions').style.display='none';
  answersEl.style.display='none';
  // reset timer
  if(timerId) clearInterval(timerId);
  secondsLeft = TOTAL_SECONDS;
  updateTimerUI();
  timerId = setInterval(()=>{
    secondsLeft--;
    updateTimerUI();
    if(secondsLeft <= 0){
      clearInterval(timerId);
      autoSubmit();
    }
  }, 1000);
});

document.getElementById('checkBtn').addEventListener('click', ()=>{
  if(timerId){ clearInterval(timerId); }
  gradeNow();
});

viewResultBtn.addEventListener('click', ()=>{
  banner.style.display = 'none';
  document.getElementById('result').scrollIntoView({behavior:'smooth'});
});

function autoSubmit(){
  timeUpUI();
  // disable all option buttons
  document.querySelectorAll('.btnopt').forEach(b=>b.disabled = true);
  gradeNow(true);
}

function timeUpUI(){
  banner.style.display = 'flex';
}

function gradeNow(auto=false){
  let correct = 0;
  const total = items.length;

  for(let i=1;i<=total;i++){
    const t = document.getElementById(`tick-${i}`);
    const ans = selected[i];
    const real = items[i-1].correct;
    if(ans === real){ correct++; t.textContent='✓ ถูก'; t.style.color='var(--good)'; }
    else{
      if(ans === undefined){ t.textContent= auto ? '⏰ หมดเวลา' : '— ยังไม่เลือก'; t.style.color='var(--muted)'; }
      else{ t.textContent=`✗ ผิด (ถูก: ${real?"ถูก":"ผิด"})`; t.style.color='var(--bad)'; }
    }
    t.classList.remove('hidden');
  }

  const pass = correct >= 16;
  resultEl.style.display='block';
  resultEl.innerHTML = `
    <div style="font-weight:800;font-size:20px">คะแนนของคุณ:
      <span class="${correct===total?'ok':'ng'}">${correct} / ${total}</span>
      — <span class="${pass?'pass':'fail'}">${pass ? 'ผ่าน 🎉' : 'ยังไม่ผ่าน ⏰'}</span>
    </div>
    <div class="tiny">เกณฑ์ผ่าน: 16/${total} • เวลาเริ่มต้น: ${TOTAL_SECONDS} วิ • เวลาเหลือ: ${secondsLeft < 0 ? 0 : secondsLeft} วิ</div>
  `;

  document.getElementById('afterActions').style.display='flex';

  // answers list
  answersEl.innerHTML = `<h3 style="margin:6px 0 8px">เฉลยพร้อมคำอธิบาย</h3>` +
    items.map((it, idx)=>`<div class="a">ข้อ ${idx+1}: ${it.correct ? "ถูก" : "ผิด"} — ${it.explain}</div>`).join('');
}
</script>
</body>
</html>
